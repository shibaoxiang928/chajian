# 命令行编译指南（无需Android Studio）

## 方案一：使用命令行工具编译

### 前置要求

1. **安装Java JDK 8或更高版本**
   - 下载地址：https://www.oracle.com/java/technologies/downloads/
   - 或使用OpenJDK：https://adoptium.net/

2. **安装Android SDK命令行工具**
   - 下载地址：https://developer.android.com/studio#command-tools
   - 下载 `commandlinetools-*.zip`
   - 解压到某个目录，例如：`C:\Android\sdk`

3. **配置环境变量**
   ```bash
   # Windows PowerShell
   $env:ANDROID_HOME = "C:\Android\sdk"
   $env:PATH += ";$env:ANDROID_HOME\platform-tools;$env:ANDROID_HOME\tools\bin"
   
   # 或添加到系统环境变量（永久）
   # ANDROID_HOME = C:\Android\sdk
   # PATH 添加: %ANDROID_HOME%\platform-tools;%ANDROID_HOME%\tools\bin
   ```

4. **安装必要的SDK组件**
   ```bash
   # 接受许可证并安装SDK
   sdkmanager --licenses
   sdkmanager "platform-tools" "platforms;android-34" "build-tools;34.0.0"
   ```

5. **安装Gradle（如果系统没有）**
   - 下载地址：https://gradle.org/releases/
   - 或使用Gradle Wrapper（项目已包含，无需单独安装）

### 编译步骤

```bash
# 1. 进入项目目录
cd 插件

# 2. 使用Gradle Wrapper编译（Windows）
.\gradlew.bat assembleDebug

# Linux/Mac
./gradlew assembleDebug

# 3. 编译完成后，APK文件在：
# app/build/outputs/apk/debug/app-debug.apk
```

### 安装到手机

```bash
# 连接手机并启用USB调试
adb devices

# 安装APK
adb install app/build/outputs/apk/debug/app-debug.apk
```

---

## 方案二：使用在线编译平台

### GitHub Actions（推荐）

1. **将项目上传到GitHub**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin <your-github-repo-url>
   git push -u origin main
   ```

2. **创建GitHub Actions工作流**
   
   创建文件：`.github/workflows/build.yml`
   
   ```yaml
   name: Build APK
   
   on:
     workflow_dispatch:
   
   jobs:
     build:
       runs-on: ubuntu-latest
       
       steps:
       - uses: actions/checkout@v3
       
       - name: Set up JDK
         uses: actions/setup-java@v3
         with:
           java-version: '11'
           distribution: 'temurin'
       
       - name: Setup Android SDK
         uses: android-actions/setup-android@v2
       
       - name: Grant execute permission for gradlew
         run: chmod +x gradlew
       
       - name: Build APK
         run: ./gradlew assembleDebug
       
       - name: Upload APK
         uses: actions/upload-artifact@v3
         with:
           name: app-debug
           path: app/build/outputs/apk/debug/app-debug.apk
   ```

3. **触发构建并下载APK**
   - 在GitHub仓库页面，点击"Actions"
   - 选择"Build APK"工作流
   - 点击"Run workflow"
   - 构建完成后下载APK

---

## 方案三：使用Docker编译

### 创建Dockerfile

```dockerfile
FROM openjdk:11-jdk

# 安装Android SDK
ENV ANDROID_SDK_ROOT=/opt/android-sdk
RUN mkdir -p ${ANDROID_SDK_ROOT}/cmdline-tools && \
    cd ${ANDROID_SDK_ROOT}/cmdline-tools && \
    wget https://dl.google.com/android/repository/commandlinetools-linux-9477386_latest.zip && \
    unzip commandlinetools-linux-*.zip && \
    rm commandlinetools-linux-*.zip && \
    mv cmdline-tools latest

ENV PATH=${PATH}:${ANDROID_SDK_ROOT}/cmdline-tools/latest/bin:${ANDROID_SDK_ROOT}/platform-tools

# 安装SDK组件
RUN yes | sdkmanager --licenses && \
    sdkmanager "platform-tools" "platforms;android-34" "build-tools;34.0.0"

WORKDIR /app
COPY . .

# 编译
RUN ./gradlew assembleDebug

# APK输出在 /app/app/build/outputs/apk/debug/app-debug.apk
```

### 使用Docker编译

```bash
# 构建镜像
docker build -t android-builder .

# 运行容器并复制APK
docker run --rm -v ${PWD}/output:/output android-builder \
  cp /app/app/build/outputs/apk/debug/app-debug.apk /output/
```

---

## 方案四：使用在线Android构建服务

### Appetize.io / Bitrise / CircleCI

这些平台提供在线Android构建服务，但通常需要注册账号。

---

## 推荐方案

**最简单**：使用GitHub Actions（方案二）
- 无需本地安装任何工具
- 自动构建并下载APK
- 完全免费

**最快**：使用命令行（方案一）
- 如果已有Android SDK环境
- 本地编译，速度快

